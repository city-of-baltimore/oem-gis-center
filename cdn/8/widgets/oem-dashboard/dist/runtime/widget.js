System.register(["jimu-core/react","jimu-arcgis","jimu-ui","esri/layers/FeatureLayer","esri/layers/Layer","esri/Basemap","esri/identity/OAuthInfo","esri/identity/IdentityManager","esri/widgets/LayerList","jimu-ui/basic/color-picker","esri/Color","esri/core/reactiveUtils"],(function(e,t){var r={},a={},i={},o={},s={},n={},l={},d={},c={},p={},m={},u={};return{setters:[function(e){r.Component=e.Component,r.default=e.default},function(e){a.JimuMapViewComponent=e.JimuMapViewComponent},function(e){i.AdvancedSelect=e.AdvancedSelect,i.Button=e.Button,i.CollapsablePanel=e.CollapsablePanel,i.Dropdown=e.Dropdown,i.DropdownButton=e.DropdownButton,i.DropdownItem=e.DropdownItem,i.DropdownMenu=e.DropdownMenu,i.Icon=e.Icon,i.Loading=e.Loading,i.Modal=e.Modal,i.ModalBody=e.ModalBody,i.ModalFooter=e.ModalFooter,i.ModalHeader=e.ModalHeader,i.Slider=e.Slider,i.Tab=e.Tab,i.Tabs=e.Tabs,i.TextInput=e.TextInput},function(e){o.default=e.default},function(e){s.default=e.default},function(e){n.default=e.default},function(e){l.default=e.default},function(e){d.default=e.default},function(e){c.default=e.default},function(e){p.ColorPicker=e.ColorPicker},function(e){m.default=e.default},function(e){u.default=e.default}],execute:function(){e((()=>{var e={208:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var a=r(81),i=r.n(a),o=r(645),s=r.n(o)()(i());s.push([e.id,".jimu-widget{position:relative}.p-5{padding:0.5rem !important}#oem-dashboard-grid{position:absolute;width:100%;height:100%;overflow:hidden;display:grid;grid-template-columns:repeat(2, 50%);grid-template-rows:180px 1fr 60px}#oem-dashboard-grid .grid-item{padding:0.5rem !important;position:relative}#oem-dashboard-grid #template-component__grid-item{grid-column:1;grid-row:1}#oem-dashboard-grid #layer-component__grid-item{grid-column:1;grid-row:2 / 4}#oem-dashboard-grid #layer-list__grid-item{grid-column:2;grid-row:1 / 3;background-color:var(--white)}#oem-dashboard-grid #save-template-grid-item{grid-column:2;grid-row:3;background-color:var(--white)}#oem-dashboard-grid .loading{height:80px;width:200px}.add-button{width:100%}.add-button .icon-btn-sizer{justify-content:left;text-align:left}.add-button .jimu-icon{margin-right:4px !important;margin-left:0 !important;margin-bottom:3px}#open-save-template-button{width:100%}#open-save-template-button .jimu-icon{margin-bottom:4px}.btn-primary{color:var(--dark-800);background-color:var(--secondary-500);border-color:var(--secondary-500)}.btn-primary:hover{background-color:var(--secondary-200);border-color:var(--secondary-200)}.advanced-select-menu .select-item-placeholder{margin:0 !important;width:0 !important}.dropdown-item:hover{background-color:var(--white) !important}.multiple-select-tool{display:none !important}.jimu-dropdown-item>.jimu-checkbox{display:none !important}@keyframes new-item{from{background-color:var(--secondary-100)}50%{background-color:var(--secondary-100)}to{background-color:transparent}}#layer-component .layer-tabs{margin-top:10px}#layer-component .layer-tabs__content{height:calc(100% - 139px);width:calc(100% - 16px);overflow-y:auto;position:absolute}#layer-component #layer-search{margin-top:10px}\n",""]);const n=s},824:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var a=r(81),i=r.n(a),o=r(645),s=r.n(o)()(i());s.push([e.id,'.jimu-widget{position:relative}.p-5{padding:0.5rem !important}#oem-dashboard-grid{position:absolute;width:100%;height:100%;overflow:hidden;display:grid;grid-template-columns:repeat(2, 50%);grid-template-rows:180px 1fr 60px}#oem-dashboard-grid .grid-item{padding:0.5rem !important;position:relative}#oem-dashboard-grid #template-component__grid-item{grid-column:1;grid-row:1}#oem-dashboard-grid #layer-component__grid-item{grid-column:1;grid-row:2 / 4}#oem-dashboard-grid #layer-list__grid-item{grid-column:2;grid-row:1 / 3;background-color:var(--white)}#oem-dashboard-grid #save-template-grid-item{grid-column:2;grid-row:3;background-color:var(--white)}#oem-dashboard-grid .loading{height:80px;width:200px}.add-button{width:100%}.add-button .icon-btn-sizer{justify-content:left;text-align:left}.add-button .jimu-icon{margin-right:4px !important;margin-left:0 !important;margin-bottom:3px}#open-save-template-button{width:100%}#open-save-template-button .jimu-icon{margin-bottom:4px}.btn-primary{color:var(--dark-800);background-color:var(--secondary-500);border-color:var(--secondary-500)}.btn-primary:hover{background-color:var(--secondary-200);border-color:var(--secondary-200)}.advanced-select-menu .select-item-placeholder{margin:0 !important;width:0 !important}.dropdown-item:hover{background-color:var(--white) !important}.multiple-select-tool{display:none !important}.jimu-dropdown-item>.jimu-checkbox{display:none !important}@keyframes new-item{from{background-color:var(--secondary-100)}50%{background-color:var(--secondary-100)}to{background-color:transparent}}#layer-list-component .esri-layer-list{height:calc(100vh - 250px);overflow-y:auto;background-color:var(--white)}#layer-list-component .esri-layer-list .esri-layer-list__no-items{display:none}#layer-list-component .esri-layer-list .esri-layer-list__item{background-color:var(--white)}#layer-list-component .esri-layer-list .esri-layer-list__item .esri-layer-list__item-container{padding-left:0;animation:new-item 5s ease-out;border:none}#layer-list-component .esri-layer-list .esri-layer-list__item .esri-layer-list__item-container .esri-layer-list__item-label{position:relative;cursor:move}#layer-list-component .esri-layer-list .esri-layer-list__item .esri-layer-list__item-container .esri-layer-list__item-label .esri-layer-list__item-toggle{position:absolute;height:100%}#layer-list-component .esri-layer-list .esri-layer-list__item .esri-layer-list__item-container .esri-layer-list__item-label .esri-layer-list__item-toggle:hover{background-color:var(--secondary-100)}#layer-list-component .esri-layer-list .esri-layer-list__item .esri-layer-list__item-container .esri-layer-list__item-label .esri-layer-list__item-title{margin-left:25px}#layer-list-component .esri-layer-list .esri-layer-list__item .esri-layer-list__item-container .esri-layer-list__item-label .esri-icon-non-visible{color:var(--light-800)}#layer-list-component .esri-layer-list .esri-layer-list__item .esri-layer-list__item-container .esri-layer-list__item-label:has(.esri-icon-non-visible){color:var(--light-800)}#layer-list-component .esri-layer-list .esri-layer-list__item .esri-layer-list__item-container .esri-layer-list__item-actions-menu-item--active[aria-label="Legend"]{transform:rotate(180deg)}#layer-list-component .esri-layer-list .esri-layer-list__item .esri-layer-list-panel{margin:0 0 5px 27px;background-color:var(--light)}#layer-list-component .esri-layer-list .esri-layer-list__item .esri-layer-list-panel .esri-layer-list-panel__content{padding:5px 0 5px 10px}#layer-list-component .esri-layer-list .esri-layer-list__item .esri-layer-list-panel .esri-layer-list-panel__content:has(.legend__templates){border-top:2px var(--light-300) solid}#layer-list-component .esri-layer-list .esri-layer-list__item .esri-layer-list-panel .esri-legend{background-color:transparent}#layer-list-component .esri-layer-list .esri-layer-list__item .esri-layer-list-panel .esri-legend .esri-legend__service{padding:0}#layer-list-component .esri-layer-list .esri-layer-list__item .esri-layer-list-panel .esri-legend .esri-legend__service .esri-legend__layer-child-table{margin:0}#layer-list-component .esri-layer-list .esri-layer-list__item .esri-layer-list__item-actions{background-color:var(--light)}#layer-list-component .esri-layer-list .esri-layer-list__item .esri-layer-list__item-actions .esri-layer-list__item-actions-list .esri-disabled-element,#layer-list-component .esri-layer-list .esri-layer-list__item .esri-layer-list__item-actions .esri-layer-list__item-actions-list .esri-disabled-element:hover{color:var(--light-800);cursor:default}#layer-list-component #layer-list__buttons{display:grid;grid-template-columns:1fr 70px;grid-template-rows:repeat(2, 50%)}#layer-list-component #layer-list__buttons button{padding:3px}#layer-list-component #layer-list__buttons #clear-all-button-grid-item{grid-column:1;grid-row:1;border-bottom:2px var(--light-300) solid !important}#layer-list-component #layer-list__buttons #clear-all-button-grid-item #clear-all-button{padding-left:0}#layer-list-component #layer-list__buttons #clear-all-button-grid-item #clear-all-button svg{margin-right:0;margin-bottom:2px}#layer-list-component #layer-list__buttons #legend-button-grid-item{grid-column:2;grid-row:1;border-bottom:2px var(--light-300) solid}#layer-list-component #layer-list__buttons #legend-button-grid-item label{font-size:var(--calcite-font-size--1);position:relative;top:4px}#layer-list-component #layer-list__buttons #legend-button-grid-item #legend-button{position:relative;bottom:2px}#layer-list-component #layer-list__buttons #layer-visibility-button-grid-item{grid-column:1;grid-row:2}.color-picker-block{display:inline-block;position:relative;top:11px;left:5px}.layer-size-slider>input{display:inline-block;width:86%;position:relative;top:3px;margin:0 10px}#picture-marker-warning{margin-top:10px}#show-legend-button:hover:not(.disabled),#hide-legend-button:hover:not(.disabled){color:var(--primary-500)}\n',""]);const n=s},986:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var a=r(81),i=r.n(a),o=r(645),s=r.n(o)()(i());s.push([e.id,".jimu-widget{position:relative}.p-5{padding:0.5rem !important}#oem-dashboard-grid{position:absolute;width:100%;height:100%;overflow:hidden;display:grid;grid-template-columns:repeat(2, 50%);grid-template-rows:180px 1fr 60px}#oem-dashboard-grid .grid-item{padding:0.5rem !important;position:relative}#oem-dashboard-grid #template-component__grid-item{grid-column:1;grid-row:1}#oem-dashboard-grid #layer-component__grid-item{grid-column:1;grid-row:2 / 4}#oem-dashboard-grid #layer-list__grid-item{grid-column:2;grid-row:1 / 3;background-color:var(--white)}#oem-dashboard-grid #save-template-grid-item{grid-column:2;grid-row:3;background-color:var(--white)}#oem-dashboard-grid .loading{height:80px;width:200px}.add-button{width:100%}.add-button .icon-btn-sizer{justify-content:left;text-align:left}.add-button .jimu-icon{margin-right:4px !important;margin-left:0 !important;margin-bottom:3px}#open-save-template-button{width:100%}#open-save-template-button .jimu-icon{margin-bottom:4px}.btn-primary{color:var(--dark-800);background-color:var(--secondary-500);border-color:var(--secondary-500)}.btn-primary:hover{background-color:var(--secondary-200);border-color:var(--secondary-200)}.advanced-select-menu .select-item-placeholder{margin:0 !important;width:0 !important}.dropdown-item:hover{background-color:var(--white) !important}.multiple-select-tool{display:none !important}.jimu-dropdown-item>.jimu-checkbox{display:none !important}@keyframes new-item{from{background-color:var(--secondary-100)}50%{background-color:var(--secondary-100)}to{background-color:transparent}}#template-component #active-templates-menu{height:60px;overflow-x:auto;overflow-y:hidden;white-space:nowrap;padding-top:12px}#template-component #active-templates-menu .scroll-item{width:150px}#template-component #active-templates-menu .nav-link{color:var(--dark-800);background-color:var(--white);border-radius:50rem;text-decoration:none;font-style:normal;cursor:default}#template-component #active-templates-menu .tab-title{margin-top:2px}#template-component #active-templates-menu #no-active-templates{padding-left:5px}#template-component #template-pane{z-index:1;width:100%;position:relative}#template-component #template-pane #template-pane__button{width:100%;text-align:left;padding:0.25rem 0.5rem}#template-component #template-pane #template-pane__button svg{position:absolute;right:4px;margin:0}#template-component #template-pane #template-pane__button.active{background-color:var(--white);color:var(--primary-500)}#template-component #template-pane #template-pane__button.active svg{transform:rotate(180deg)}#template-component #template-pane #template-pane__content{height:calc(100vh - 263px);position:relative;background-color:var(--light);overflow-y:auto;border-top:2px var(--light-500) solid !important}#template-component #template-pane #template-pane__content .template-dropdown__content{margin-left:15px;border-left:2px var(--light-300) solid}#template-component #template-pane>.setting-collapse>.collapse-header{display:none}#template-component #template-pane>.setting-collapse{border-bottom:1px var(--light-500) solid}#template-component #template-pane .collapse-label{padding-left:5px}#template-component #template-pane #template-pane__content.more-info .setting-collapse:has(.collapse.show){animation:new-item 5s ease-out}.template-search-item{width:100%}.template-search-item .template-search-item__add-button{width:calc(100% - 55px)}\n",""]);const n=s},459:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var a=r(81),i=r.n(a),o=r(645),s=r.n(o)()(i());s.push([e.id,".jimu-widget{position:relative}.p-5{padding:0.5rem !important}#oem-dashboard-grid{position:absolute;width:100%;height:100%;overflow:hidden;display:grid;grid-template-columns:repeat(2, 50%);grid-template-rows:180px 1fr 60px}#oem-dashboard-grid .grid-item{padding:0.5rem !important;position:relative}#oem-dashboard-grid #template-component__grid-item{grid-column:1;grid-row:1}#oem-dashboard-grid #layer-component__grid-item{grid-column:1;grid-row:2 / 4}#oem-dashboard-grid #layer-list__grid-item{grid-column:2;grid-row:1 / 3;background-color:var(--white)}#oem-dashboard-grid #save-template-grid-item{grid-column:2;grid-row:3;background-color:var(--white)}#oem-dashboard-grid .loading{height:80px;width:200px}.add-button{width:100%}.add-button .icon-btn-sizer{justify-content:left;text-align:left}.add-button .jimu-icon{margin-right:4px !important;margin-left:0 !important;margin-bottom:3px}#open-save-template-button{width:100%}#open-save-template-button .jimu-icon{margin-bottom:4px}.btn-primary{color:var(--dark-800);background-color:var(--secondary-500);border-color:var(--secondary-500)}.btn-primary:hover{background-color:var(--secondary-200);border-color:var(--secondary-200)}.advanced-select-menu .select-item-placeholder{margin:0 !important;width:0 !important}.dropdown-item:hover{background-color:var(--white) !important}.multiple-select-tool{display:none !important}.jimu-dropdown-item>.jimu-checkbox{display:none !important}@keyframes new-item{from{background-color:var(--secondary-100)}50%{background-color:var(--secondary-100)}to{background-color:transparent}}\n",""]);const n=s},645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r="",a=void 0!==t[5];return t[4]&&(r+="@supports (".concat(t[4],") {")),t[2]&&(r+="@media ".concat(t[2]," {")),a&&(r+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),r+=e(t),a&&(r+="}"),t[2]&&(r+="}"),t[4]&&(r+="}"),r})).join("")},t.i=function(e,r,a,i,o){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(a)for(var n=0;n<this.length;n++){var l=this[n][0];null!=l&&(s[l]=!0)}for(var d=0;d<e.length;d++){var c=[].concat(e[d]);a&&s[c[0]]||(void 0!==o&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=o),r&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=r):c[2]=r),i&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=i):c[4]="".concat(i)),t.push(c))}},t}},81:e=>{"use strict";e.exports=function(e){return e[1]}},379:e=>{"use strict";var t=[];function r(e){for(var r=-1,a=0;a<t.length;a++)if(t[a].identifier===e){r=a;break}return r}function a(e,a){for(var o={},s=[],n=0;n<e.length;n++){var l=e[n],d=a.base?l[0]+a.base:l[0],c=o[d]||0,p="".concat(d," ").concat(c);o[d]=c+1;var m=r(p),u={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==m)t[m].references++,t[m].updater(u);else{var h=i(u,a);a.byIndex=n,t.splice(n,0,{identifier:p,updater:h,references:1})}s.push(p)}return s}function i(e,t){var r=t.domAPI(t);return r.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;r.update(e=t)}else r.remove()}}e.exports=function(e,i){var o=a(e=e||[],i=i||{});return function(e){e=e||[];for(var s=0;s<o.length;s++){var n=r(o[s]);t[n].references--}for(var l=a(e,i),d=0;d<o.length;d++){var c=r(o[d]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}o=l}}},569:e=>{"use strict";var t={};e.exports=function(e,r){var a=function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}(e);if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(r)}},216:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,r)=>{"use strict";e.exports=function(e){var t=r.nc;t&&e.setAttribute("nonce",t)}},795:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(r){!function(e,t,r){var a="";r.supports&&(a+="@supports (".concat(r.supports,") {")),r.media&&(a+="@media ".concat(r.media," {"));var i=void 0!==r.layer;i&&(a+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),a+=r.css,i&&(a+="}"),r.media&&(a+="}"),r.supports&&(a+="}");var o=r.sourceMap;o&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleTagTransform(a,e,t.options)}(t,e,r)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},673:e=>{"use strict";e.exports=n},639:e=>{"use strict";e.exports=m},135:e=>{"use strict";e.exports=u},380:e=>{"use strict";e.exports=d},263:e=>{"use strict";e.exports=l},818:e=>{"use strict";e.exports=o},195:e=>{"use strict";e.exports=s},447:e=>{"use strict";e.exports=c},826:e=>{"use strict";e.exports=a},315:e=>{"use strict";e.exports=r},726:e=>{"use strict";e.exports=i},362:e=>{"use strict";e.exports=p}},t={};function h(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={id:r,exports:{}};return e[r](i,i.exports,h),i.exports}h.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return h.d(t,{a:t}),t},h.d=(e,t)=>{for(var r in t)h.o(t,r)&&!h.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},h.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),h.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},h.p="",h.nc=void 0;var y={};return h.p=window.jimuConfig.baseUrl,(()=>{"use strict";h.r(y),h.d(y,{__set_webpack_public_path__:()=>we,default:()=>be});var e=h(379),t=h.n(e),r=h(795),a=h.n(r),i=h(569),o=h.n(i),s=h(565),n=h.n(s),l=h(216),d=h.n(l),c=h(589),p=h.n(c),m=h(459),u={};u.styleTagTransform=p(),u.setAttributes=n(),u.insert=o().bind(null,"head"),u.domAPI=a(),u.insertStyleElement=d(),t()(m.Z,u),m.Z&&m.Z.locals&&m.Z.locals;var g=h(315),f=h(826),v=h(726),b=h(818),w=h(195),E=h(673),_=function(){return _=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},_.apply(this,arguments)},T=function(e,t){return T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},T(e,t)},L=function(){return L=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},L.apply(this,arguments)};function k(e){return Object.keys(e).some((function(t){var r=e[t];if(!r)return!1;switch(r&&r.toParam&&(r=r.toParam()),r.constructor.name){case"Array":case"Object":case"Date":case"Function":case"Boolean":case"String":case"Number":return!1;default:return!0}}))}function C(e){var t={};return Object.keys(e).forEach((function(r){var a,i,o=e[r];if(o&&o.toParam&&(o=o.toParam()),o||0===o||"boolean"==typeof o||"string"==typeof o){var s;switch(o.constructor.name){case"Array":var n=null===(i=null===(a=o[0])||void 0===a?void 0:a.constructor)||void 0===i?void 0:i.name;s="Array"===n?o:"Object"===n?JSON.stringify(o):o.join(",");break;case"Object":s=JSON.stringify(o);break;case"Date":s=o.valueOf();break;case"Function":s=null;break;case"Boolean":s=o+"";break;default:s=o}(s||0===s||"string"==typeof s||Array.isArray(s))&&(t[r]=s)}})),t}function O(e,t){return Array.isArray(t)&&t[0]&&Array.isArray(t[0])?t.map((function(t){return O(e,t)})).join("&"):encodeURIComponent(e)+"="+encodeURIComponent(t)}function x(e){var t=C(e);return Object.keys(t).map((function(e){return O(e,t[e])})).join("&")}var S=function(e,t,r,a,i){e=e||"UNKNOWN_ERROR",t=t||"UNKNOWN_ERROR_CODE",this.name="ArcGISRequestError",this.message="UNKNOWN_ERROR_CODE"===t?e:t+": "+e,this.originalMessage=e,this.code=t,this.response=r,this.url=a,this.options=i};S.prototype=Object.create(Error.prototype),S.prototype.constructor=S;var I="@esri/arcgis-rest-js",A={httpMethod:"POST",params:{f:"json"}},M=function(e){function t(t,r,a,i,o){void 0===t&&(t="AUTHENTICATION_ERROR"),void 0===r&&(r="AUTHENTICATION_ERROR_CODE");var s=e.call(this,t,r,a,i,o)||this;return s.name="ArcGISAuthError",s.message="AUTHENTICATION_ERROR_CODE"===r?t:r+": "+t,s}return function(e,t){function r(){this.constructor=e}T(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}(t,e),t.prototype.retry=function(e,t){var r=this;void 0===t&&(t=3);var a=0,i=function(o,s){e(r.url,r.options).then((function(e){var t=L(L({},r.options),{authentication:e});return a+=1,j(r.url,t)})).then((function(e){o(e)})).catch((function(e){"ArcGISAuthError"===e.name&&a<t?i(o,s):"ArcGISAuthError"===e.name&&a>=t?s(r):s(e)}))};return new Promise((function(e,t){i(e,t)}))},t}(S);function j(e,t){void 0===t&&(t={params:{f:"json"}});var r=L(L(L({httpMethod:"POST"},A),t),{params:L(L({},A.params),t.params),headers:L(L({},A.headers),t.headers)}),a=[],i=[];if(r.fetch||"undefined"==typeof fetch?(a.push("`fetch`"),i.push("`node-fetch`")):r.fetch=fetch.bind(Function("return this")()),"undefined"==typeof Promise&&(a.push("`Promise`"),i.push("`es6-promise`")),"undefined"==typeof FormData&&(a.push("`FormData`"),i.push("`isomorphic-form-data`")),!r.fetch||"undefined"==typeof Promise||"undefined"==typeof FormData)throw new Error("`arcgis-rest-request` requires a `fetch` implementation and global variables for `Promise` and `FormData` to be present in the global scope. You are missing "+a.join(", ")+". We recommend installing the "+i.join(", ")+" modules at the root of your application to add these to the global scope. See https://bit.ly/2KNwWaJ for more info.");var o=r.httpMethod,s=r.authentication,n=r.rawResponse,l=L({f:"json"},r.params),d=null,c={method:o,credentials:r.credentials||"same-origin"};return r.headers&&r.headers["X-Esri-Auth-Client-Id"]&&e.indexOf("/oauth2/platformSelf")>-1&&(c.credentials="include"),(s?s.getToken(e,{fetch:r.fetch}).catch((function(t){return t.url=e,t.options=r,d=t,Promise.resolve("")})):Promise.resolve("")).then((function(t){t.length&&(l.token=t),s&&s.getDomainCredentials&&(c.credentials=s.getDomainCredentials(e));var a={};if("GET"===c.method){l.token&&r.hideToken&&"undefined"==typeof window&&(a["X-Esri-Authorization"]="Bearer "+l.token,delete l.token);var i=""===x(l)?e:e+"?"+x(l);r.maxUrlLength&&i.length>r.maxUrlLength||l.token&&r.hideToken?(c.method="POST",t.length&&r.hideToken&&(l.token=t,delete a["X-Esri-Authorization"])):e=i}var o=new RegExp("/items/.+/updateResources").test(e);return"POST"===c.method&&(c.body=function(e,t){var r=k(e)||t,a=C(e);if(r){var i=new FormData;return Object.keys(a).forEach((function(e){if("undefined"!=typeof Blob&&a[e]instanceof Blob){var t=a.fileName||a[e].name||e;i.append(e,a[e],t)}else a[e].constructor&&"ReadStream"===a[e].constructor.name&&Number.isInteger(a.dataSize)?i.append(e,a[e],{knownLength:a.dataSize}):i.append(e,a[e])})),i}return x(e)}(l,o)),c.headers=L(L({},a),r.headers),"undefined"!=typeof window||c.headers.referer||(c.headers.referer=I),k(l)||o||(c.headers["Content-Type"]="application/x-www-form-urlencoded"),r.fetch(e,c)})).then((function(t){if(!t.ok){var a=t.status,i=t.statusText;throw new S(i,"HTTP "+a,t,e,r)}if(n)return t;switch(l.f){case"json":case"geojson":return t.json();case"html":case"text":return t.text();default:return t.blob()}})).then((function(t){if("json"!==l.f&&"geojson"!==l.f||n)return t;var a=function(e,t,r,a,i){if(e.code>=400){var o=e.message,s=e.code;throw new S(o,s,e,t,a)}if(e.error){var n=e.error,l=(o=n.message,s=n.code,n.messageCode),d=l||s||"UNKNOWN_ERROR_CODE";if(498===s||499===s||"GWM_0003"===l||400===s&&"Unable to generate token."===o)throw i||new M(o,d,e,t,a);throw new S(o,d,e,t,a)}if("failed"===e.status||"failure"===e.status){o=void 0,s="UNKNOWN_ERROR_CODE";try{o=JSON.parse(e.statusMessage).message,s=JSON.parse(e.statusMessage).code}catch(t){o=e.statusMessage||e.message}throw new S(o,s,e,t,a)}return e}(t,e,0,r,d);if(d){var i=e.toLowerCase().split(/\/rest(\/admin)?\/services\//)[0];r.authentication.federatedServers[i]={token:[],expires:new Date(Date.now()+864e5)},d=null}return a}))}function R(e){return j(("string"!=typeof(t=e.url)||"/"===(t=t.trim())[t.length-1]&&(t=t.slice(0,-1)),t+"/addFeatures"),function(e,t,r){var a=L(L({params:{}},r),e);return a.params=["features","gdbVersion","returnEditMoment","rollbackOnFailure"].reduce((function(t,r){return(e[r]||"boolean"==typeof e[r])&&(t[r]=e[r]),t}),a.params),["params","httpMethod","rawResponse","authentication","portal","fetch","maxUrlLength","headers"].reduce((function(e,t){return a[t]&&(e[t]=a[t]),e}),{})}(e,0,{params:_({},e.params)}));var t}var N=h(263),D=h(380),W=h(208),P={};P.styleTagTransform=p(),P.setAttributes=n(),P.insert=o().bind(null,"head"),P.domAPI=a(),P.insertStyleElement=d(),t()(W.Z,P),W.Z&&W.Z.locals&&W.Z.locals;class z extends g.Component{render(){return g.default.createElement(v.Button,{"aria-label":"Button",icon:!0,onClick:()=>this.props.onAddLayer(this.props.layerWrapper),size:"sm",type:"tertiary",className:"add-button",disabled:this.props.active},g.default.createElement(v.Icon,{icon:this.props.active?"https://raw.githubusercontent.com/Esri/calcite-ui-icons/master/icons/check-32.svg":"https://raw.githubusercontent.com/Esri/calcite-ui-icons/master/icons/plus-32.svg",size:"l"}),this.props.layerWrapper.title)}}const B=z;class H extends g.Component{render(){return g.default.createElement("div",{id:"layer-search"},g.default.createElement(v.AdvancedSelect,{isMultiple:!0,isEmptyOptionHidden:!0,onChange:function(){},placeholder:"Search for layer...",size:"default",sortValuesByLabel:!0,staticValues:this.props.layers.map((e=>({label:e.title,value:e.id,render:t=>g.default.createElement(B,{layerWrapper:e,onAddLayer:this.props.onAddLayer,active:this.props.activeLayers.includes(e)})})))}))}}const F=H;class V extends g.Component{constructor(){super(...arguments),this.renderCategoryTabs=()=>this.props.categories.map((e=>g.default.createElement(v.Tab,{id:"category-"+e.id+"-tab",className:"tab",title:e.title+" ("+e.layerWrappers.length+")"},g.default.createElement("div",{id:"category-"+e.id+"-tab-content",className:"layer-tabs__content p-5 border"},e.layerWrappers.map((e=>g.default.createElement(B,{layerWrapper:e,onAddLayer:this.props.onAddLayer,active:this.props.activeLayers.includes(e)})))))))}render(){return g.default.createElement("div",{id:"layer-component"},g.default.createElement("h3",null,"Layers"),this.props.layers&&g.default.createElement(F,{layers:this.props.layers,onAddLayer:this.props.onAddLayer,activeLayers:this.props.activeLayers}),g.default.createElement("div",{className:"layer-tabs"},g.default.createElement(v.Tabs,{onChange:function(){},onClose:function(){},type:"tabs",scrollable:!0},this.props.categories&&this.renderCategoryTabs())))}}const U=V;class Z extends g.Component{constructor(e){super(e),this.toggleOpen=()=>{this.setState({open:!this.state.open})},this.checkValidity=e=>({valid:e.length<=50,msg:"Maximum title length is 50 characters!"}),this.state={title:void 0,open:!1}}render(){return g.default.createElement("div",{id:"save-template-component"},this.props.show&&g.default.createElement(v.Button,{onClick:this.toggleOpen,id:"open-save-template-button",type:"primary"},g.default.createElement(v.Icon,{icon:"https://raw.githubusercontent.com/Esri/calcite-ui-icons/master/icons/plus-32.svg",size:"l"}),"Save As New Template"),g.default.createElement(v.Modal,{isOpen:this.state.open,onClosed:function(){},onEnter:function(){},onExit:function(){},onOpened:function(){},toggle:this.toggleOpen},g.default.createElement(v.ModalHeader,{toggle:this.toggleOpen},"Save As New Template"),g.default.createElement(v.ModalBody,null,"Template Title:",g.default.createElement(v.TextInput,{className:"mb-3",placeholder:"Enter Template Title...",onAcceptValue:e=>this.setState({title:e}),checkValidityOnChange:this.checkValidity,checkValidityOnAccept:this.checkValidity})),g.default.createElement(v.ModalFooter,null,g.default.createElement(v.Button,{onClick:this.toggleOpen},"Cancel"),g.default.createElement(v.Button,{onClick:()=>{this.props.handleClick(this.state.title),this.toggleOpen()},id:"save-template-button",type:"primary"},"Save"))))}}const J=Z;var q=h(824),G={};G.styleTagTransform=p(),G.setAttributes=n(),G.insert=o().bind(null,"head"),G.domAPI=a(),G.insertStyleElement=d(),t()(q.Z,G),q.Z&&q.Z.locals&&q.Z.locals;var Y=h(447),K=h(362),X=h(639);class Q extends g.Component{constructor(e){super(e),this.onOpened=()=>{let e=this.props.layer.renderer.symbol;switch(e.type){case"simple-marker":this.setState({showColorPicker:!0,showSizeSlider:!0,color:e.color.toString(),size:e.size});break;case"picture-marker":this.setState({showColorPicker:!1,showSizeSlider:!0,color:"#ffffff",size:e.width});break;default:this.setState({showColorPicker:!0,showSizeSlider:!1,color:e.color.toString(),size:null})}},this.handleSave=()=>{let e=this.props.layer.renderer;switch(e.symbol.type){case"simple-marker":e.symbol.color=new X.default(this.state.color),e.symbol.size=this.state.size;break;case"picture-marker":let t=e.symbol,r=t.height/t.width;t.width=this.state.size,t.height=this.state.size*r;break;default:e.symbol.color=new X.default(this.state.color)}this.props.onSave()},this.state={showColorPicker:!1,showSizeSlider:!1,color:null,size:null}}render(){return g.default.createElement(v.Modal,{isOpen:this.props.open,onClosed:function(){},onEnter:function(){},onExit:function(){},onOpened:this.onOpened,toggle:this.props.toggleOpen},g.default.createElement(v.ModalHeader,{toggle:this.props.toggleOpen},"Edit Layer Style"),g.default.createElement(v.ModalBody,null,this.state.showSizeSlider&&g.default.createElement("div",{className:"layer-size-slider"},"Size:",g.default.createElement(v.Slider,{"aria-label":"Layer Size Slider",onChange:e=>this.setState({size:+e.target.value}),min:0,max:Math.max(100,this.state.size),value:this.state.size}),g.default.createElement("label",null,this.state.size)),this.state.showColorPicker&&g.default.createElement("div",{className:"layer-color-picker"},"Color:",g.default.createElement(K.ColorPicker,{"aria-label":"Layer Color Picker",color:this.state.color,height:30,width:30,onChange:e=>{this.setState({color:e})},onClick:function(){},placement:"bottom",type:"default"}))),g.default.createElement(v.ModalFooter,null,g.default.createElement(v.Button,{onClick:this.props.toggleOpen},"Cancel"),g.default.createElement(v.Button,{onClick:this.handleSave,id:"save-template-button",type:"primary"},"Save")))}}const $=Q;var ee=h(135);class te extends g.Component{constructor(e){super(e),this.state={legendMenuOpen:!1}}render(){return g.default.createElement("div",{id:"layer-list__buttons"},g.default.createElement("div",{id:"clear-all-button-grid-item"},g.default.createElement(v.Button,{"aria-label":"Button",onClick:this.props.onClearAll,size:"default",id:"clear-all-button",type:"tertiary"},"Clear All")),g.default.createElement("div",{id:"legend-button-grid-item"},g.default.createElement(v.Dropdown,{isOpen:this.state.legendMenuOpen},g.default.createElement("label",null,"Legend"),g.default.createElement(v.DropdownButton,{id:"legend-button",arrow:g.default.createElement(v.Icon,{icon:"https://raw.githubusercontent.com/Esri/calcite-ui-icons/master/icons/hamburger-32.svg"}),type:"tertiary",onClick:()=>this.setState({legendMenuOpen:!this.state.legendMenuOpen}),icon:!0}),g.default.createElement(v.DropdownMenu,{alignment:"end"},g.default.createElement(v.DropdownItem,{onClick:this.props.onShowLegend,id:"show-legend-button",type:"tertiary",disabled:this.props.allLegendsOpen},"Show All"),g.default.createElement(v.DropdownItem,{onClick:this.props.onHideLegend,id:"hide-legend-button",type:"tertiary",disabled:this.props.allLegendsClosed},"Hide All")))),g.default.createElement("div",{id:"layer-visibility-grid-item"},g.default.createElement(v.Button,{id:"layer-visibility-button",type:"tertiary",onClick:()=>{this.props.allLayersHidden?this.props.onShowLayers():this.props.onHideLayers()}},g.default.createElement(v.Icon,{icon:this.props.allLayersHidden?"https://raw.githubusercontent.com/Esri/calcite-ui-icons/master/icons/view-hide-32.svg":"https://raw.githubusercontent.com/Esri/calcite-ui-icons/master/icons/view-visible-32.svg",size:"l"}),this.props.allLayersHidden?"Show All":"Hide All")))}}const re=te;class ae extends g.Component{constructor(e){super(e),this.onOpened=()=>{return e=this,t=void 0,a=function*(){this.setState({source:"...",description:"...",url:""});let e=yield this.props.getLayerInfo(this.props.layer);e&&this.setState(e)},new((r=void 0)||(r=Promise))((function(i,o){function s(e){try{l(a.next(e))}catch(e){o(e)}}function n(e){try{l(a.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,n)}l((a=a.apply(e,t||[])).next())}));var e,t,r,a},this.state={source:"...",description:"...",url:""}}render(){return g.default.createElement(v.Modal,{isOpen:this.props.open,onClosed:function(){},onEnter:function(){},onExit:function(){},onOpened:this.onOpened,toggle:this.props.toggleOpen},g.default.createElement(v.ModalHeader,{toggle:this.props.toggleOpen},"Layer Description"),g.default.createElement(v.ModalBody,null,g.default.createElement("div",{className:"layer-source"},"Source: ",this.state.source),g.default.createElement("div",{className:"layer-description"},"Description: ",this.state.description)),g.default.createElement(v.ModalFooter,null,g.default.createElement(v.Button,{onClick:this.props.toggleOpen},"Close"),this.state.url&&g.default.createElement(v.Button,{onClick:()=>window.open(this.state.url,"_blank"),type:"primary"},"See More")))}}const ie=ae;class oe extends g.Component{constructor(e){super(e),this.myRef=g.default.createRef(),this.onItemClick=e=>{},this.showLegend=()=>{for(let e of this.state.widget.operationalItems)e.panel.open=!0},this.hideLegend=()=>{for(let e of this.state.widget.operationalItems)e.panel.open=!1},this.showLayers=()=>{for(let e of this.state.widget.operationalItems)e.layer.visible=!0},this.hideLayers=()=>{for(let e of this.state.widget.operationalItems)e.layer.visible=!1},this.toggleLayerStyleModal=()=>{},this.changeStyle=()=>{this.refresh(this.state.selectedItem),this.toggleLayerStyleModal()},this.createLegendDiv=()=>{let e=document.createElement("div");return e.className="legend__header",e.innerHTML="Legend: ",e},this.createTemplatesDiv=e=>{let t=document.createElement("div");t.className="legend__templates";let r=this.props.getLayerTemplates(e,!0);if(0===r.length)return t.innerHTML="Templates: None",t;let a="Templates: ";for(let e of r)a+=" "+e.title+",";return t.innerHTML=a.slice(0,-1),t},this.createCategoryDiv=e=>{let t=document.createElement("div");return t.className="legend__category",t.innerHTML="Category: "+this.props.getLayerCategory(e).title,t},this.refresh=e=>{e.parent?e.panel.content=["legend"]:e.panel.content=[this.createLegendDiv(),"legend",this.createTemplatesDiv(e.layer),this.createCategoryDiv(e.layer)]},this.activeViewChangeHandler=e=>{if(this.state.jmv&&this.state.widget&&this.state.widget.destroy(),e&&(this.setState({jmv:e}),this.myRef.current)){const t=new Y.default({view:e.view,listItemCreatedFunction:e=>{return r=this,a=void 0,o=function*(){let r=e.item;r.panel={className:"esri-icon-down"},this.refresh(r),yield r.layer.when(),r.actionsSections=[[{title:"Remove",className:"esri-icon-minus",id:"remove"}],[{title:"Zoom to",className:"esri-icon-zoom-in-magnifying-glass",id:"zoom"}],[{title:"Edit layer style",image:"https://raw.githubusercontent.com/Esri/calcite-ui-icons/master/icons/layers-editable-24.svg",id:"change-style",disabled:!("feature"===r.layer.type&&"simple"===r.layer.renderer.type&&(null!=r.layer.renderer.symbol.color||"picture-marker"===r.layer.renderer.symbol.type))}],[{title:"Send backwards",image:"https://raw.githubusercontent.com/Esri/calcite-ui-icons/master/icons/send-backwards-24.svg",id:"send-backwards"},{title:"Bring forward",image:"https://raw.githubusercontent.com/Esri/calcite-ui-icons/master/icons/bring-forward-24.svg",id:"bring-forward"},{title:"Send to back",image:"https://raw.githubusercontent.com/Esri/calcite-ui-icons/master/icons/send-to-back-24.svg",id:"send-to-back"},{title:"Bring to front",image:"https://raw.githubusercontent.com/Esri/calcite-ui-icons/master/icons/bring-to-front-24.svg",id:"bring-to-front"}],[{title:"Description",className:"esri-icon-description",id:"description"}]],r.addHandles([ee.default.watch((()=>t.selectedItems.includes(r)),(()=>this.onItemClick(r))),ee.default.when((()=>r.panel.open),(()=>r.actionsOpen=!1)),ee.default.when((()=>r.actionsOpen),(()=>r.panel.open=!1))])},new((i=void 0)||(i=Promise))((function(e,t){function s(e){try{l(o.next(e))}catch(e){t(e)}}function n(e){try{l(o.throw(e))}catch(e){t(e)}}function l(t){var r;t.done?e(t.value):(r=t.value,r instanceof i?r:new i((function(e){e(r)}))).then(s,n)}l((o=o.apply(r,a||[])).next())}));var r,a,i,o},container:this.myRef.current,selectionEnabled:!0,multipleSelectionEnabled:!0});t.on("trigger-action",(t=>{const r=t.action.id,a=t.item.layer;let i=this.state.jmv.view.map.layers.findIndex((e=>e===a));switch(r){case"zoom":e.view.goTo(a.fullExtent);break;case"remove":this.props.onRemoveLayer(a);break;case"change-style":this.setState({layerStyleModalOpen:!0,selectedItem:t.item});break;case"send-backwards":i>0&&this.state.jmv.view.map.reorder(a,i-1);break;case"bring-forward":i>-1&&i<this.state.jmv.view.map.layers.length&&this.state.jmv.view.map.reorder(a,i+1);break;case"send-to-back":i>-1&&this.state.jmv.view.map.reorder(a,0);break;case"bring-to-front":i>-1&&this.state.jmv.view.map.reorder(a,this.state.jmv.view.map.layers.length-1);break;case"description":this.setState({moreInfoModalOpen:!0,selectedItem:t.item})}})),t.addHandles([ee.default.watch((()=>t.operationalItems.reduce(((e,t)=>e&&!t.layer.visible),!0)),(()=>this.setState({allLayersHidden:t.operationalItems.reduce(((e,t)=>e&&!t.layer.visible),!0)}))),ee.default.watch((()=>t.operationalItems.reduce(((e,t)=>e&&t.panel.open),!0)),(()=>this.setState({allLegendsOpen:t.operationalItems.reduce(((e,t)=>e&&t.panel.open),!0)}))),ee.default.watch((()=>t.operationalItems.reduce(((e,t)=>e&&!t.panel.open),!0)),(()=>this.setState({allLegendsClosed:t.operationalItems.reduce(((e,t)=>e&&!t.panel.open),!0)})))]),this.setState({widget:t})}},this.state={jmv:null,widget:null,layerStyleModalOpen:!1,moreInfoModalOpen:!1,selectedItem:null,allLayersHidden:!1,allLegendsOpen:!1,allLegendsClosed:!0}}render(){if(this.state.widget)for(let e of this.state.widget.viewModel.operationalItems)this.refresh(e);return g.default.createElement("div",{id:"layer-list-component"},g.default.createElement(f.JimuMapViewComponent,{useMapWidgetId:this.props.useMapWidgetId,onActiveViewChange:this.activeViewChangeHandler}),g.default.createElement("h3",null,"Current Layers ("+this.props.numActiveLayers+")"),this.props.numActiveLayers<=0&&g.default.createElement("em",null,"Get started by adding a template or layer from the left side of the panel"),this.props.numActiveLayers>0&&g.default.createElement(re,{onClearAll:this.props.onClearAll,onHideLegend:this.hideLegend,onShowLegend:this.showLegend,onShowLayers:this.showLayers,onHideLayers:this.hideLayers,allLayersHidden:this.state.allLayersHidden,allLegendsOpen:this.state.allLegendsOpen,allLegendsClosed:this.state.allLegendsClosed}),g.default.createElement("div",{id:"layer-list__content",ref:this.myRef}),this.state.selectedItem&&this.state.selectedItem.layer&&"feature"===this.state.selectedItem.layer.type&&"simple"===this.state.selectedItem.layer.renderer.type&&g.default.createElement($,{onSave:this.changeStyle,layer:this.state.selectedItem.layer,open:this.state.layerStyleModalOpen,toggleOpen:()=>this.setState({layerStyleModalOpen:!this.state.layerStyleModalOpen})}),this.state.selectedItem&&this.state.selectedItem.layer&&g.default.createElement(ie,{layer:this.state.selectedItem.layer,open:this.state.moreInfoModalOpen,toggleOpen:()=>this.setState({moreInfoModalOpen:!this.state.moreInfoModalOpen}),getLayerInfo:this.props.getLayerInfo}))}}const se=oe;var ne=h(986),le={};le.styleTagTransform=p(),le.setAttributes=n(),le.insert=o().bind(null,"head"),le.domAPI=a(),le.insertStyleElement=d(),t()(ne.Z,le),ne.Z&&ne.Z.locals&&ne.Z.locals;class de extends g.Component{render(){return g.default.createElement(v.CollapsablePanel,{label:g.default.createElement(v.Button,{"aria-label":"Button",icon:!0,onClick:()=>this.props.onAddTemplate(this.props.template),size:"sm",type:"tertiary",disabled:0===this.props.template.layerWrappers.length,className:"add-button"},g.default.createElement(v.Icon,{icon:"https://raw.githubusercontent.com/Esri/calcite-ui-icons/master/icons/plus-32.svg",size:"l"}),this.props.template.title+" ("+this.props.template.layerWrappers.length+")"),level:0,type:"default",disabled:0===this.props.template.layerWrappers.length,defaultIsOpen:this.props.open,onRequestClose:this.props.toggle,onRequestOpen:this.props.toggle},g.default.createElement("div",{className:"template-dropdown__content"},this.props.template.layerWrappers.map(((e,t)=>{let r=this.props.template.layerWrappers[this.props.template.layerWrappers.length-t-1];return g.default.createElement(B,{layerWrapper:r,onAddLayer:this.props.onAddLayer,active:this.props.activeLayers.includes(r)})}))))}}const ce=de;class pe extends g.Component{render(){return g.default.createElement("div",{id:"template-search"},g.default.createElement(v.AdvancedSelect,{isMultiple:!1,isEmptyOptionHidden:!0,onChange:function(){},placeholder:"Search for template...",size:"default",sortValuesByLabel:!0,toggle:this.props.onToggle,staticValues:this.props.templates.map((e=>({label:e.title,value:e.id,render:t=>g.default.createElement("span",{className:"template-search-item"},g.default.createElement(v.Button,{"aria-label":"Button",icon:!0,onClick:()=>this.props.onAddTemplate(e),size:"sm",type:"tertiary",className:"template-search-item__add-button add-button",disabled:0===e.layerWrappers.length},g.default.createElement(v.Icon,{icon:"https://raw.githubusercontent.com/Esri/calcite-ui-icons/master/icons/plus-32.svg",size:"l"}),e.title+" ("+e.layerWrappers.length+")"),g.default.createElement(v.Button,{onClick:()=>this.props.onMoreInfo(e),size:"sm",type:"tertiary",className:"template-search-item__info-button",disabled:0===e.layerWrappers.length},g.default.createElement(v.Icon,{icon:"https://raw.githubusercontent.com/Esri/calcite-ui-icons/master/icons/hamburger-32.svg",size:"l"})))})))}))}}const me=pe;class ue extends g.Component{render(){return g.default.createElement("div",{id:"active-templates-menu"},0===this.props.activeTemplates.length&&g.default.createElement("div",{id:"no-active-templates"},g.default.createElement("em",null,"Added templates will appear here")),g.default.createElement(v.Tabs,{scrollable:!0,type:"pills"},this.props.activeTemplates.map((e=>g.default.createElement(v.Tab,{id:""+e.id,title:e.title+" ("+e.layerWrappers.length+")",onClose:()=>this.props.removeTemplate(e),closeable:!0})))))}}const he=ue;class ye extends g.Component{constructor(e){super(e),this.togglePaneOpen=()=>{this.setState({paneOpen:!this.state.paneOpen,selectedTemplate:null})},this.moreInfo=e=>{this.setState({paneOpen:!0,selectedTemplate:e})},this.state={paneOpen:!1,selectedTemplate:null}}render(){return g.default.createElement("div",null,g.default.createElement("h3",null,"Templates"),this.props.templates&&g.default.createElement("div",{id:"template-component"},g.default.createElement(me,{templates:this.props.templates,onAddTemplate:this.props.onAddTemplate,onMoreInfo:this.moreInfo,onToggle:e=>{e&&this.setState({paneOpen:!1})}}),g.default.createElement(he,{activeTemplates:this.props.activeTemplates,removeTemplate:this.props.onRemoveTemplate}),g.default.createElement("div",{id:"template-pane"},g.default.createElement(v.Button,{onClick:this.togglePaneOpen,id:"template-pane__button",type:"tertiary",active:this.state.paneOpen},"View All",g.default.createElement(v.Icon,{icon:"https://raw.githubusercontent.com/Esri/calcite-ui-icons/master/icons/chevron-down-32.svg",size:"l"})),g.default.createElement(v.CollapsablePanel,{label:"",level:0,type:"default",onRequestOpen:this.togglePaneOpen,onRequestClose:this.togglePaneOpen,isOpen:this.state.paneOpen},g.default.createElement("div",{id:"template-pane__content",className:"p-5 border"+(this.state.selectedTemplate?" more-info":"")},this.props.templates.map((e=>g.default.createElement(ce,{template:e,onAddTemplate:this.props.onAddTemplate,open:this.state.selectedTemplate===e,toggle:()=>this.setState({selectedTemplate:null}),onAddLayer:this.props.onAddLayer,activeLayers:this.props.activeLayers}))))))))}}const ge=ye;var fe=function(e,t,r,a){return new(r||(r=Promise))((function(i,o){function s(e){try{l(a.next(e))}catch(e){o(e)}}function n(e){try{l(a.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,n)}l((a=a.apply(e,t||[])).next())}))};class ve extends g.Component{constructor(e){super(e),this.fetchCategories=()=>fe(this,void 0,void 0,(function*(){let e=yield this.categoryTable.queryFeatures({where:"1=1",outFields:["*"],orderByFields:["TITLE"]}),t=new Map;for(let r of e.features)t.set(r.attributes.OBJECTID,{id:r.attributes.OBJECTID,title:r.attributes.TITLE,layerWrappers:[]});this.setState({categories:t})})),this.fetchTemplates=()=>fe(this,void 0,void 0,(function*(){let e=yield this.templateTable.queryFeatures({where:"1=1",outFields:["*"],orderByFields:["TITLE"]}),t=new Map;for(let r of e.features)t.set(r.attributes.OBJECTID,{id:r.attributes.OBJECTID,title:r.attributes.TITLE,layerWrappers:[]});this.setState({templates:t})})),this.fetchLayers=()=>fe(this,void 0,void 0,(function*(){let e=yield this.layerTable.queryFeatures({where:"1=1",outFields:["OBJECTID","TITLE","URL","SCOPE","CATEGORYID","RENDERER"],orderByFields:["SCOPE","TITLE"]}),t=new Map;for(let r of e.features){let e={id:r.attributes.OBJECTID,title:r.attributes.SCOPE+" "+r.attributes.TITLE,url:r.attributes.URL,renderer:r.attributes.RENDERER,layer:null,category:this.state.categories.get(r.attributes.CATEGORYID),templates:[]};try{this.createLayer(e),t.set(r.attributes.OBJECTID,e),this.state.categories.get(r.attributes.CATEGORYID).layerWrappers.push(e)}catch(t){console.error(t);for(let t of e.templates)t.layerWrappers=t.layers.filter((t=>t.id!==e.id));alert(t.message)}}this.setState({layerWrappers:t})})),this.createLayer=e=>fe(this,void 0,void 0,(function*(){try{let t=yield w.default.fromArcGISServerUrl({url:e.url});if(t.id=e.id.toString(),t.title=e.title,null!=e.renderer&&"feature"===t.type)try{t.renderer=JSON.parse(e.renderer)}catch(t){console.log("Error loading renderer for layer "+e.title),console.error(t)}return e.layer=t,t}catch(t){throw console.error(t),new Error("Error loading layer"+e.title+"!")}})),this.fetchTemplateLayers=()=>fe(this,void 0,void 0,(function*(){let e=yield this.templateLayerRelationships.queryFeatures({where:"1=1",outFields:["*"],orderByFields:["OBJECTID"]});for(let t of e.features){let e=this.state.layerWrappers.get(t.attributes.LAYERID);if(e){let r=this.state.templates.get(t.attributes.TEMPLATEID);r.layerWrappers.push(e),this.state.layerWrappers.get(t.attributes.LAYERID).templates.push(r)}}this.setState({templates:this.state.templates,loading:!1})})),this.postTemplate=e=>fe(this,void 0,void 0,(function*(){try{if(e)if((yield this.templateTable.queryFeatureCount({where:"TITLE = '"+e+"'",outFields:["*"]}))>0)alert("Error, a template with this title already exists!");else{let t=yield this.getToken(),r=(yield R({url:this.props.config.templateTableUrl,features:[{attributes:{TITLE:e}}],params:{token:t}})).addResults[0].objectId;yield this.postTemplateLayers(r,t),yield this.fetchTemplates(),yield this.fetchTemplateLayers(),alert("Successfully saved new template!")}else alert("Error, please enter a title!")}catch(e){console.error(e),alert("Error saving template, please try again!")}})),this.postTemplateLayers=(e,t)=>fe(this,void 0,void 0,(function*(){let r=[],a=this.state.jimuMapView.view.map.allLayers;for(let t of a)this.state.layerWrappers.has(+t.id)&&r.push({attributes:{TEMPLATEID:e,LAYERID:t.id}});yield R({url:this.props.config.templateLayerRelationshipsUrl,features:r,params:{token:t}})})),this.getToken=()=>fe(this,void 0,void 0,(function*(){const e=new N.default({appId:"eS2vUdIZbHaVOrDz",flowType:"auto",popup:!1});D.default.registerOAuthInfos([e]);let t=yield D.default.checkSignInStatus(e.portalUrl+"/sharing");return t||(t=yield D.default.getCredential(e.portalUrl+"/sharing")),t.token})),this.addActiveLayer=e=>fe(this,void 0,void 0,(function*(){if(e.layer||(yield this.createLayer(e)),!this.state.activeLayers.includes(e)){let t=this.state.activeLayers.slice();t.push(e),e.layer.visible=!0,this.state.jimuMapView.view.map.add(e.layer),this.setState({activeLayers:t})}})),this.addActiveTemplate=e=>fe(this,void 0,void 0,(function*(){if(!this.state.activeTemplates.includes(e)){let t=this.state.activeTemplates.slice(),r=this.state.activeLayers.slice();t.push(e);for(let t of e.layerWrappers)t.layer||(yield this.createLayer(t)),r.includes(t)||(r.push(t),t.layer.visible=!0,this.state.jimuMapView.view.map.add(t.layer));this.setState({activeTemplates:t,activeLayers:r})}})),this.removeActiveLayer=e=>{let t=this.state.activeLayers.filter((t=>t.layer!==e)),r=this.state.activeTemplates;this.state.jimuMapView.view.map.remove(e);for(let a of r)if(this.state.layerWrappers.get(+e.id).templates.includes(a)){let e=!1;for(let r of a.layerWrappers)if(t.includes(r)){e=!0;break}e||(r=r.filter((e=>e!==a)))}this.setState({activeTemplates:r,activeLayers:t})},this.removeActiveTemplate=e=>{let t=this.state.activeLayers.slice(),r=this.state.activeTemplates.filter((t=>t!==e));for(let a of e.layerWrappers){let e=!1;for(let t of r)if(a.templates.includes(t)){e=!0;break}e||(t=t.filter((e=>e!==a)),this.state.jimuMapView.view.map.remove(a.layer))}this.setState({activeTemplates:r,activeLayers:t})},this.clearAll=()=>{this.state.jimuMapView.view.map.removeAll(),this.setState({activeTemplates:[],activeLayers:[]})},this.getLayerTemplates=(e,t)=>{if(!this.state.layerWrappers.get(+e.id))return[];if(t){let t=[];for(let r of this.state.layerWrappers.get(+e.id).templates)this.state.activeTemplates.includes(r)&&t.push(r);return t}return this.state.layerWrappers.get(+e.id).templates},this.getLayerCategory=e=>this.state.layerWrappers.get(+e.id)?this.state.layerWrappers.get(+e.id).category:null,this.getLayerInfo=e=>fe(this,void 0,void 0,(function*(){try{if(!this.state.layerWrappers.get(+e.id))return null;let t=yield this.layerTable.queryFeatures({where:"OBJECTID = "+e.id,outFields:["SOURCE","DESCRIPTION"]});return 1===t.features.length?{source:t.features[0].attributes.SOURCE,description:t.features[0].attributes.DESCRIPTION,url:this.state.layerWrappers.get(+e.id).url}:(alert("Error loading layer info!"),{source:"Error",description:"Error",url:this.state.layerWrappers.get(+e.id).url})}catch(t){return alert("Error loading layer info!"),console.error(t),{source:"Error",description:"Error",url:this.state.layerWrappers.get(+e.id).url}}})),this.activeViewChangeHandler=e=>{e&&(this.state.jimuMapView||(e.view.map.basemap=E.default.fromId("arcgis-topographic")),this.setState({jimuMapView:e}))},this.state={jimuMapView:void 0,layerWrappers:new Map,templates:new Map,categories:new Map,loading:!0,activeTemplates:[],activeLayers:[]}}componentDidMount(){return fe(this,void 0,void 0,(function*(){try{this.templateTable=new b.default({url:this.props.config.templateTableUrl}),this.layerTable=new b.default({url:this.props.config.layerTableUrl}),this.categoryTable=new b.default({url:this.props.config.categoryTableUrl}),this.templateLayerRelationships=new b.default({url:this.props.config.templateLayerRelationshipsUrl})}catch(e){return console.error(e),void alert("Error connecting to database, please try again!")}try{yield this.fetchCategories()}catch(e){return console.error(e),void alert("Error loading categories, please try again!")}try{yield this.fetchTemplates()}catch(e){return console.error(e),void alert("Error loading templates, please try again!")}try{yield this.fetchLayers()}catch(e){return console.error(e),void alert("Error loading layers, please try again!")}try{yield this.fetchTemplateLayers()}catch(e){return console.error(e),void alert("Error loading template layers, please try again!")}}))}render(){var e,t;return g.default.createElement("div",{className:"widget-starter jimu-widget"},this.props.useMapWidgetIds&&1===this.props.useMapWidgetIds.length&&g.default.createElement(f.JimuMapViewComponent,{useMapWidgetId:null===(e=this.props.useMapWidgetIds)||void 0===e?void 0:e[0],onActiveViewChange:this.activeViewChangeHandler}),g.default.createElement("div",{id:"oem-dashboard-grid"},g.default.createElement("div",{id:"template-component__grid-item",className:"grid-item"},this.state.jimuMapView&&g.default.createElement(ge,{templates:Array.from(this.state.templates.values()),activeTemplates:this.state.activeTemplates,onAddTemplate:this.addActiveTemplate,onRemoveTemplate:this.removeActiveTemplate,activeLayers:this.state.activeLayers,onAddLayer:this.addActiveLayer})),g.default.createElement("div",{id:"layer-component__grid-item",className:"grid-item"},this.state.loading&&g.default.createElement(v.Loading,{type:"SECONDARY"}),this.state.jimuMapView&&g.default.createElement(U,{layers:Array.from(this.state.layerWrappers.values()),categories:Array.from(this.state.categories.values()),activeLayers:this.state.activeLayers,onAddLayer:this.addActiveLayer})),g.default.createElement("div",{id:"layer-list__grid-item",className:"grid-item"},!(this.props.useMapWidgetIds&&1===this.props.useMapWidgetIds.length)&&g.default.createElement(v.Loading,{type:"SECONDARY"}),this.props.useMapWidgetIds&&1===this.props.useMapWidgetIds.length&&g.default.createElement(se,{useMapWidgetId:null===(t=this.props.useMapWidgetIds)||void 0===t?void 0:t[0],onClearAll:this.clearAll,onRemoveLayer:this.removeActiveLayer,getLayerTemplates:this.getLayerTemplates,getLayerCategory:this.getLayerCategory,numActiveLayers:this.state.activeLayers.length,getLayerInfo:this.getLayerInfo})),g.default.createElement("div",{id:"save-template-grid-item",className:"grid-item"},g.default.createElement(J,{handleClick:this.postTemplate,show:this.state.activeLayers.length>0}))))}}const be=ve;function we(e){h.p=e}})(),y})())}}}));